"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.generator = void 0;
const zod_1 = require("zod");
const classes_1 = require("./classes");
const generateMultipleFiles_1 = require("./generateMultipleFiles");
const generateSingleFile_1 = require("./generateSingleFile");
const utils_1 = require("./utils");
const outputSchema = zod_1.z.object({
    fromEnvVar: zod_1.z.string().nullable(),
    value: zod_1.z.string({ required_error: 'No output path specified' }),
});
const generator = async (config) => {
    const output = outputSchema.parse(config.output);
    if (await (0, utils_1.skipGenerator)()) {
        return console.log('\x1b[33m', '!!!! Generation of zod schemas skipped! Generator is disabled in "zodGenConfig.js" !!!!', '\x1b[37m');
    }
    const extendedDMMF = new classes_1.ExtendedDMMF(config.dmmf, config.config, config.datamodel);
    classes_1.DirectoryHelper.removeDir(output.value);
    classes_1.DirectoryHelper.createDir(output.value);
    if (extendedDMMF.generatorConfig.useMultipleFiles) {
        return (0, generateMultipleFiles_1.generateMultipleFiles)({
            dmmf: extendedDMMF,
            path: output.value,
        });
    }
    return (0, generateSingleFile_1.generateSingleFile)({
        dmmf: extendedDMMF,
        path: output.value,
    });
};
exports.generator = generator;
//# sourceMappingURL=generator.js.map