{"version":3,"sources":["../../src/satellite/error.ts"],"sourcesContent":["import { SatelliteError, SatelliteErrorCode } from '../util'\nimport Log from 'loglevel'\n\nconst fatalErrorDescription =\n  \"Client can't connect with the server after a fatal error. This can happen due to divergence between local client and server. Use developer tools to clear the local database, or delete the database file. We're working on tools to allow recovering the state of the local database.\"\n\nconst throwErrors = [\n  SatelliteErrorCode.INTERNAL,\n  SatelliteErrorCode.FATAL_ERROR,\n  SatelliteErrorCode.CONNECTION_CANCELLED_BY_DISCONNECT,\n  SatelliteErrorCode.REPLICATION_TRANSFORM_ERROR,\n]\n\nconst fatalErrors = [\n  SatelliteErrorCode.INVALID_REQUEST,\n  SatelliteErrorCode.UNKNOWN_SCHEMA_VSN,\n  SatelliteErrorCode.AUTH_REQUIRED,\n  SatelliteErrorCode.AUTH_EXPIRED,\n]\n\nconst outOfSyncErrors = [\n  SatelliteErrorCode.INVALID_POSITION,\n  SatelliteErrorCode.BEHIND_WINDOW,\n  SatelliteErrorCode.SUBSCRIPTION_NOT_FOUND,\n]\n\nexport function isThrowable(error: SatelliteError) {\n  return throwErrors.includes(error.code)\n}\n\nexport function isFatal(error: SatelliteError) {\n  return fatalErrors.includes(error.code)\n}\n\nexport function isOutOfSyncError(error: SatelliteError) {\n  return outOfSyncErrors.includes(error.code)\n}\n\nfunction logFatalErrorDescription() {\n  Log.error(fatalErrorDescription)\n}\n\nexport function wrapFatalError(error: SatelliteError) {\n  logFatalErrorDescription()\n  return new SatelliteError(\n    SatelliteErrorCode.FATAL_ERROR,\n    `Fatal error: ${error.message}. Check log for more information`\n  )\n}\n"],"mappings":"AAAA,SAAS,gBAAgB,0BAA0B;AACnD,OAAO,SAAS;AAEhB,MAAM,wBACJ;AAEF,MAAM,cAAc;AAAA,EAClB,mBAAmB;AAAA,EACnB,mBAAmB;AAAA,EACnB,mBAAmB;AAAA,EACnB,mBAAmB;AACrB;AAEA,MAAM,cAAc;AAAA,EAClB,mBAAmB;AAAA,EACnB,mBAAmB;AAAA,EACnB,mBAAmB;AAAA,EACnB,mBAAmB;AACrB;AAEA,MAAM,kBAAkB;AAAA,EACtB,mBAAmB;AAAA,EACnB,mBAAmB;AAAA,EACnB,mBAAmB;AACrB;AAEO,SAAS,YAAY,OAAuB;AACjD,SAAO,YAAY,SAAS,MAAM,IAAI;AACxC;AAEO,SAAS,QAAQ,OAAuB;AAC7C,SAAO,YAAY,SAAS,MAAM,IAAI;AACxC;AAEO,SAAS,iBAAiB,OAAuB;AACtD,SAAO,gBAAgB,SAAS,MAAM,IAAI;AAC5C;AAEA,SAAS,2BAA2B;AAClC,MAAI,MAAM,qBAAqB;AACjC;AAEO,SAAS,eAAe,OAAuB;AACpD,2BAAyB;AACzB,SAAO,IAAI;AAAA,IACT,mBAAmB;AAAA,IACnB,gBAAgB,MAAM,OAAO;AAAA,EAC/B;AACF;","names":[]}